
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>gatenlp.gateslave &#8212; GATE NLP library (gatenlp)  documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">GATE NLP library (gatenlp)  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for gatenlp.gateslave</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module for interacting with a Java GATE process, running API commands on it and</span>
<span class="sd">exchanging data with it.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">platform</span> <span class="k">as</span> <span class="nn">sysplatform</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">atexit</span>
<span class="c1"># NOTE: we delay imporint py4j to the class initializer. This allows us to make GateSlave available via gatenlp</span>
<span class="c1"># but does not force everyone to actually have py4j installed if they do not use the GateSlave</span>
<span class="c1"># from py4j.java_gateway import JavaGateway, GatewayParameters</span>
<span class="kn">from</span> <span class="nn">gatenlp</span> <span class="kn">import</span> <span class="n">Document</span>

<span class="n">JARVERSION</span> <span class="o">=</span> <span class="s2">&quot;1.0&quot;</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">()</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>


<div class="viewcode-block" id="classpath_sep"><a class="viewcode-back" href="../../gatenlp.gateslave.html#gatenlp.gateslave.classpath_sep">[docs]</a><span class="k">def</span> <span class="nf">classpath_sep</span><span class="p">(</span><span class="n">platform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the classpath separator character for the current operating system / platform.</span>

<span class="sd">    :return: classpath separator character</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">platform</span><span class="p">:</span>
        <span class="n">myplatform</span> <span class="o">=</span> <span class="n">sysplatform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">myplatform</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not determine operating system, please use platform parameter&quot;</span><span class="p">)</span>
        <span class="n">platform</span> <span class="o">=</span> <span class="n">myplatform</span>
    <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;windows&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;:&quot;</span></div>


<div class="viewcode-block" id="gate_classpath"><a class="viewcode-back" href="../../gatenlp.gateslave.html#gatenlp.gateslave.gate_classpath">[docs]</a><span class="k">def</span> <span class="nf">gate_classpath</span><span class="p">(</span><span class="n">gatehome</span><span class="p">,</span> <span class="n">platform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the GATE classpath components as a string, with the element seperator characters appropriate</span>
<span class="sd">    for the operating system.</span>
<span class="sd">    :param gatehome: where GATE is installed, either as a cloned git repo or a downloaded installation dir.</span>
<span class="sd">    :return: GATE classpath</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check which kind of GATE home we have: if there is a distro subdirectory, assume cloned git repo</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">gatehome</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;GATE home directory does not exist: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gatehome</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">gatehome</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;GATE home directory does not a directory: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gatehome</span><span class="p">))</span>
    <span class="n">cpsep</span> <span class="o">=</span> <span class="n">classpath_sep</span><span class="p">(</span><span class="n">platform</span><span class="p">)</span>
    <span class="n">cpfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gatehome</span><span class="p">,</span> <span class="s2">&quot;gate.classpath&quot;</span><span class="p">)</span>
    <span class="n">bindir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gatehome</span><span class="p">,</span> <span class="s2">&quot;bin&quot;</span><span class="p">)</span>
    <span class="c1"># logger.info(&quot;DEBUG checking for {}&quot;.format(cpfile))</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cpfile</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cpfile</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;File not found </span><span class="si">{}</span><span class="s2">, distribution may need compiling&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cpfile</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">cpfile</span><span class="p">,</span> <span class="s2">&quot;rt&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">cp</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">cp</span> <span class="o">+</span> <span class="n">cpsep</span> <span class="o">+</span> <span class="n">bindir</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># logger.info(&quot;DEBUG {} does not exist&quot;.format(cpfile))</span>
        <span class="n">libdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gatehome</span><span class="p">,</span> <span class="s2">&quot;lib&quot;</span><span class="p">)</span>
        <span class="n">bindir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">gatehome</span><span class="p">,</span> <span class="s2">&quot;bin&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">libdir</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not determine class path from </span><span class="si">{}</span><span class="s2">, no lib directory&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gatehome</span><span class="p">))</span>
        <span class="c1"># jars = glob.glob(os.path.join(libdir,&quot;*.jar&quot;))</span>
        <span class="c1"># return cpsep.join(jars)</span>
        <span class="k">return</span> <span class="n">libdir</span> <span class="o">+</span> <span class="n">cpsep</span> <span class="o">+</span> <span class="n">bindir</span></div>


<div class="viewcode-block" id="GateSlave"><a class="viewcode-back" href="../../gatenlp.gateslave.html#gatenlp.gateslave.GateSlave">[docs]</a><span class="k">class</span> <span class="nc">GateSlave</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">25333</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">java</span><span class="o">=</span><span class="s2">&quot;java&quot;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">gatehome</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">platform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an instance of the GateSlave and either start our own Java GATE process for it to use</span>
<span class="sd">        (start=True) or connect to an existing one (start=False).</span>

<span class="sd">        After the GateSlave instance has been create successfully, it is possible to:</span>

<span class="sd">        * Use one of the methods of the instance to perform operations on the Java side or exchange data</span>

<span class="sd">        * use GateSlave.slave to invoke methods from the PythonSlave class on the Java side</span>

<span class="sd">        * use GateSlave.jvm to directly construct objects or call instance or static methods</span>

<span class="sd">        NOTE: the GATE process must not output anything important/big to stderr because everything from</span>
<span class="sd">        stderr gets captured and used for communication between the Java and Python processes. At least</span>
<span class="sd">        part of the output to stderr may only be passed on after the GATE process has ended.</span>

<span class="sd">        Example: ::</span>

<span class="sd">            gs = GateSlave()</span>
<span class="sd">            pipeline = gs.slave.loadPipelineFromFile(&quot;thePipeline.xgapp&quot;)</span>
<span class="sd">            doc = gs.slave.createDocument(&quot;Some document text&quot;)</span>
<span class="sd">            gs.slave.run4doc(pipeline,doc)</span>
<span class="sd">            pdoc = gs.gdoc2pdoc(doc)</span>
<span class="sd">            gs.slave.deleteResource(doc)</span>
<span class="sd">            # process the gatenlp Document pdoc ...</span>

<span class="sd">        :param port: port to use</span>
<span class="sd">        :param java: path to the java binary to run or the java command to use from the PATH (for start=True)</span>
<span class="sd">        :param host: host an existing Java GATE process is running on (only relevant for start=False)</span>
<span class="sd">        :param gatehome: where GATE is installed (only relevant if start=True). If None, expects</span>
<span class="sd">               environment variable GATE_HOME to be set.</span>
<span class="sd">        :param platform: system platform we run on, one of Windows, Linux (also for MacOs) or Java</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">py4j.java_gateway</span> <span class="kn">import</span> <span class="n">JavaGateway</span><span class="p">,</span> <span class="n">GatewayParameters</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gatehome</span> <span class="o">=</span> <span class="n">gatehome</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gatehome</span> <span class="o">=</span> <span class="n">gatehome</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">platform</span> <span class="o">=</span> <span class="n">platform</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gateprocess</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gateway</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slave</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">gatehome</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">start</span><span class="p">:</span>
            <span class="n">gatehome</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;GATE_HOME&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">gatehome</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Parameter gatehome is None and environment var GATE_HOME not set&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gatehome</span> <span class="o">=</span> <span class="n">gatehome</span>
        <span class="k">if</span> <span class="n">start</span><span class="p">:</span>
            <span class="c1"># make sure we find the jar we need</span>
            <span class="c1"># logger.info(&quot;DEBUG: file location: {}&quot;.format(__file__))</span>
            <span class="n">jarloc</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;_jars&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;gatetools-gatenlpslave-</span><span class="si">{</span><span class="n">JARVERSION</span><span class="si">}</span><span class="s2">.jar&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">jarloc</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not find jar, </span><span class="si">{}</span><span class="s2"> does not exist&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jarloc</span><span class="p">))</span>
            <span class="n">cmdandparms</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">cmdandparms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">java</span><span class="p">)</span>
            <span class="n">cmdandparms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-cp&quot;</span><span class="p">)</span>
            <span class="n">cpsep</span> <span class="o">=</span> <span class="n">classpath_sep</span><span class="p">(</span><span class="n">platform</span><span class="o">=</span><span class="n">platform</span><span class="p">)</span>
            <span class="n">cmdandparms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jarloc</span> <span class="o">+</span> <span class="n">cpsep</span> <span class="o">+</span> <span class="n">gate_classpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gatehome</span><span class="p">,</span> <span class="n">platform</span><span class="o">=</span><span class="n">platform</span><span class="p">))</span>
            <span class="n">cmdandparms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;gate.tools.gatenlpslave.GatenlpSlave&quot;</span><span class="p">)</span>
            <span class="n">cmdandparms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">port</span><span class="p">))</span>
            <span class="n">cmdandparms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
            <span class="n">subproc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmdandparms</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">bufsize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gateprocess</span> <span class="o">=</span> <span class="n">subproc</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">subproc</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;PYTHON SLAVE SERVER OK&quot;</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;PYTHON SLAVE SERVER NOT OK&quot;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not start server, giving up&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gateway</span> <span class="o">=</span> <span class="n">JavaGateway</span><span class="p">(</span><span class="n">gateway_parameters</span><span class="o">=</span><span class="n">GatewayParameters</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jvm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">jvm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slave</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">entry_point</span>

<div class="viewcode-block" id="GateSlave.close"><a class="viewcode-back" href="../../gatenlp.gateslave.html#gatenlp.gateslave.GateSlave.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clean up: if the gate slave process was started by us, we will shut it down.</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gateprocess</span><span class="o">.</span><span class="n">stderr</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gateprocess</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span></div>

<div class="viewcode-block" id="GateSlave.load_gdoc"><a class="viewcode-back" href="../../gatenlp.gateslave.html#gatenlp.gateslave.GateSlave.load_gdoc">[docs]</a>    <span class="k">def</span> <span class="nf">load_gdoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Let GATE load a document from the given path and return a handle to it.</span>

<span class="sd">        :param path: path to the gate document to load.</span>
<span class="sd">        :param mimetype: a mimetype to use when loading.</span>
<span class="sd">        :return: a handle to the GATE document</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mimetype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mimetype</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">slave</span><span class="o">.</span><span class="n">loadDocumentFromFile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">mimetype</span><span class="p">)</span></div>

<div class="viewcode-block" id="GateSlave.save_gdoc"><a class="viewcode-back" href="../../gatenlp.gateslave.html#gatenlp.gateslave.GateSlave.save_gdoc">[docs]</a>    <span class="k">def</span> <span class="nf">save_gdoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdoc</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save GATE document to the given path.</span>

<span class="sd">        :param gdoc: GATE document handle</span>
<span class="sd">        :param path:  destination path</span>
<span class="sd">        :param mimetype: mimtetype, only the following types are allowed: &quot;&quot;/None: GATE XML,</span>
<span class="sd">               application/fastinfoset, and all mimetypes supported by the Format_Bdoc plugin.</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mimetype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mimetype</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slave</span><span class="o">.</span><span class="n">saveDocumentToFile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">mimetype</span><span class="p">)</span></div>

<div class="viewcode-block" id="GateSlave.gdoc2pdoc"><a class="viewcode-back" href="../../gatenlp.gateslave.html#gatenlp.gateslave.GateSlave.gdoc2pdoc">[docs]</a>    <span class="k">def</span> <span class="nf">gdoc2pdoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdoc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the GATE document to a python document and return it.</span>

<span class="sd">        :param gdoc: the handle to a GATE document</span>
<span class="sd">        :return: a gatenlp Document instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bjs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slave</span><span class="o">.</span><span class="n">getBdocJson</span><span class="p">(</span><span class="n">gdoc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Document</span><span class="o">.</span><span class="n">load_string</span><span class="p">(</span><span class="n">bjs</span><span class="p">)</span></div>

<div class="viewcode-block" id="GateSlave.pdoc2gdoc"><a class="viewcode-back" href="../../gatenlp.gateslave.html#gatenlp.gateslave.GateSlave.pdoc2gdoc">[docs]</a>    <span class="k">def</span> <span class="nf">pdoc2gdoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdoc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the Python gatenlp document to a GATE document and return a handle to it.</span>

<span class="sd">        :param pdoc: python gatenlp Document</span>
<span class="sd">        :return: handle to GATE document</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">json</span> <span class="o">=</span> <span class="n">pdoc</span><span class="o">.</span><span class="n">save_string</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">slave</span><span class="o">.</span><span class="n">getDocument4BdocJson</span><span class="p">(</span><span class="n">json</span><span class="p">)</span></div>

<div class="viewcode-block" id="GateSlave.load_pdoc"><a class="viewcode-back" href="../../gatenlp.gateslave.html#gatenlp.gateslave.GateSlave.load_pdoc">[docs]</a>    <span class="k">def</span> <span class="nf">load_pdoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load a document from the given path, using GATE and convert and return as gatenlp Python document.</span>

<span class="sd">        :param path: path to load document from</span>
<span class="sd">        :param mimetype: mime type to use</span>
<span class="sd">        :return: gatenlp document</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gdoc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_gdoc</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">mimetype</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gdoc2pdoc</span><span class="p">(</span><span class="n">gdoc</span><span class="p">)</span></div>

<div class="viewcode-block" id="GateSlave.del_gdoc"><a class="viewcode-back" href="../../gatenlp.gateslave.html#gatenlp.gateslave.GateSlave.del_gdoc">[docs]</a>    <span class="k">def</span> <span class="nf">del_gdoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gdoc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete/unload the GATE document from GATE.</span>
<span class="sd">        This is necessary to do for each GATE document that is not used anymore, otherwise the documents</span>
<span class="sd">        will accumulate in the Java process and eat up all memory. NOTE: just removing all references to the</span>
<span class="sd">        GATE document does not delete/unload the document!</span>

<span class="sd">        :param gdoc: the document to remove</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jvm</span><span class="o">.</span><span class="n">gate</span><span class="o">.</span><span class="n">Factory</span><span class="o">.</span><span class="n">deleteResource</span><span class="p">(</span><span class="n">gdoc</span><span class="p">)</span></div>

<div class="viewcode-block" id="GateSlave.show_gui"><a class="viewcode-back" href="../../gatenlp.gateslave.html#gatenlp.gateslave.GateSlave.show_gui">[docs]</a>    <span class="k">def</span> <span class="nf">show_gui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show the GUI for the started GATE process. NOTE: this is more of a hack and may cause sync problems</span>
<span class="sd">        when closing down the GATE slave.</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slave</span><span class="o">.</span><span class="n">showGui</span><span class="p">()</span></div></div>

</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">GATE NLP library (gatenlp)  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, University of Sheffield.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.
    </div>
  </body>
</html>