<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>gatenlp.serialization.default_htmlannviewer API documentation</title>
<meta name="description" content="Module that implements the various ways of how to save and load documents and change logs." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>gatenlp.serialization.default_htmlannviewer</code></h1>
</header>
<section id="section-intro">
<p>Module that implements the various ways of how to save and load documents and change logs.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
Module that implements the various ways of how to save and load documents and change logs.
&#34;&#34;&#34;
import os
from random import choice
from string import ascii_uppercase
from gatenlp.document import Document
from gatenlp.gatenlpconfig import gatenlpconfig
import json as jsonlib

JS_JQUERY_URL = &#34;https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js&#34;
JS_GATENLP_URL = &#34;https://unpkg.com/gatenlp-ann-viewer@1.0.17/gatenlp-ann-viewer.js&#34;
JS_JQUERY = f&#34;&lt;script src=\&#34;{JS_JQUERY_URL}\&#34;&gt;&lt;/script&gt;&#34;
JS_GATENLP = f&#34;&lt;script src=\&#34;{JS_GATENLP_URL}\&#34;&gt;&lt;/script&gt;&#34;
HTML_TEMPLATE_FILE_NAME = &#34;gatenlp-ann-viewer.html&#34;
JS_GATENLP_FILE_NAME = &#34;gatenlp-ann-viewer-merged.js&#34;

html_ann_viewer_serializer_js_loaded = False

SEP = &#34;â•‘&#34;


def init_javscript():
    &#34;&#34;&#34;
    Initialize the notebook/html javascript.
    &#34;&#34;&#34;
    from IPython.display import display_html   # pylint: disable=C0415

    display_html(HtmlAnnViewerSerializer.javascript(), raw=True)


def show_colab(
        doc,
        htmlid=None,
        display=False,
        annspec=None,
        preselect=None,
        palette=None,
        cols4types=None,
        doc_style=None,
        row1_style=None,
        row2_style=None
):
    &#34;&#34;&#34;
    Show htmldocumentviewe in a colab notebook.
    &#34;&#34;&#34;
    from IPython.display import display_html, Javascript   # pylint: disable=C0415
    from IPython.display import display as i_display   # pylint: disable=C0415
    i_display(Javascript(url=JS_JQUERY_URL))
    i_display(Javascript(url=JS_GATENLP_URL))
    html = doc.save_mem(
        fmt=&#34;html-ann-viewer&#34;,
        notebook=True,
        add_js=False,
        offline=True,
        htmlid=htmlid,
        annspec=annspec,
        preselect=preselect,
        palette=palette,
        cols4types=cols4types,
        stretch_height=False,
        doc_style=doc_style,
        row1_style=row1_style,
        row2_style=row2_style,
    )
    if display:
        display_html(html, raw=True)
        return None
    else:
        return html


def show_notebook(
        doc,
        htmlid=None,
        display=False,
        annspec=None,
        preselect=None,
        palette=None,
        cols4types=None,
        doc_style=None,
        row1_style=None,
        row2_style=None
):
    &#34;&#34;&#34;
    Show htmldocumentviewer in a jupyter notebook.
    &#34;&#34;&#34;
    if not gatenlpconfig.notebook_js_initialized:
        init_javscript()
        gatenlpconfig.notebook_js_initialized = True
    html = doc.save_mem(
        fmt=&#34;html-ann-viewer&#34;,
        notebook=True,
        add_js=False,
        offline=True,
        htmlid=htmlid,
        annspec=annspec,
        preselect=preselect,
        palette=palette,
        cols4types=cols4types,
        stretch_height=False,
        doc_style=doc_style,
        row1_style=row1_style,
        row2_style=row2_style,
    )
    if display:
        from IPython.display import display_html  # pylint: disable=C0415
        display_html(html, raw=True)
        return None
    else:
        return html


class HtmlAnnViewerSerializer:
    &#34;&#34;&#34;
    Serialization class for generating HTML/Javascript to view a document in an HTML page or in a Jupyter or
    Colab notebook.
    &#34;&#34;&#34;

    @staticmethod
    def javascript():
        &#34;&#34;&#34;
        Return the Javascript needed for the HTML Annotation viewer.

        Returns: Javascript string.

        &#34;&#34;&#34;
        jsloc = os.path.join(
            os.path.dirname(__file__), &#34;_htmlviewer&#34;, JS_GATENLP_FILE_NAME
        )
        if not os.path.exists(jsloc):
            raise Exception(
                &#34;Could not find JavsScript file, {} does not exist&#34;.format(jsloc)
            )
        with open(jsloc, &#34;rt&#34;, encoding=&#34;utf-8&#34;) as infp:
            js = infp.read()
            js = &#34;&#34;&#34;&lt;script type=&#34;text/javascript&#34;&gt;&#34;&#34;&#34; + js + &#34;&lt;/script&gt;&#34;
        return js

    @staticmethod
    def save(
            _clazz,
            inst,
            to_ext=None,
            to_mem=None,
            notebook=False,
            offline=False,
            add_js=True,
            htmlid=None,
            stretch_height=False,
            annspec=None,
            preselect=None,
            palette=None,
            cols4types=None,
            doc_style=None,
            row1_style=None,
            row2_style=None,
            **kwargs,
    ):
        &#34;&#34;&#34;Convert a document to HTML for visualizing it.

        Args:
            _clazz: the class of the object to save
            inst: the instance/object to save
            to_ext:  the destination where to save to unless to_mem is given
            to_mem: if true, ignores to_ext and returns the representation
            notebook: if True only create a div which can be injected into a notebook or other HTML, otherwise
                generate a full HTML document
            offline: if true, include all the Javascript needed in the generated HTML , otherwise load library
                from the internet.
            add_js: if true (default), add the necessary Javascript either directly or by loading a library from
                the internet. If false, assume that the Javascript is already there (only makes sense with
                notebook=True).
            htmlid: the id to use for HTML ids so it is possible to have several independent viewers in the
                same HTML page and to style the output from a separate notebook cell
            stretch_height: if False, rows 1 and 2 of the viewer will not have the height set, but only
                min and max height (default min is 10em for row1 and 7em for row2, max is the double of those).
                If True, no max haight is set and instead the height is set to a percentage (default is
                67vh for row 1 and 30vh for row 2). The values used can be changed via gateconfig or the
                complete style for the rows can be set directly via row1_style and row2_style.
            annspec: if None, include all annotation sets and types, otherwise this should be a list of either
                set names, or tuples, where the first entry is a set name and the second entry is either a type
                name or list of type names to include.
            preselect: if not None, the set and type names to pre-select (show). This should have the same format
                as the annspec parameter.
            palette: if not None a list of colour codes (strings) usable in Javascript which will be used instead
                of the default palette.
            cols4types: if not None a dictionary mapping tuples (setname, typename) to a color. For the given
                setname and typename combinations, the colours from the palette (default or specified) will be
                overrriden.
            doc_style: if not None, any additional styling for the document text box, if None, use whatever
                is defined as gatenlpconfig.doc_html_repr_doc_style or do not use.
            row1_style: the style to use for the first row of the document viewer which shows the document text and
                annotation set and type panes. The default is gatenlpconfig.doc_html_repr_row1style_nostretch or
                gatenlpconfig.doc_html_repr_row1style_nostretch depending on the stretch_height parameter.
            row2_style: the style to use for the second row of the document viewer which shows the document or
                annotation features. The default is gatenlpconfig.doc_html_repr_row2style_nostretch or
                gatenlpconfig.doc_html_repr_row2style_nostretch depending on the stretch_height parameter.
            kwargs: swallow any other kwargs.

        Returns: if to_mem is True, returns the representation, otherwise None.

        &#34;&#34;&#34;
        if not isinstance(inst, Document):
            raise Exception(&#34;Not a document!&#34;)
        parms = dict(presel_set=[], presel_list=[])
        doccopy = inst.deepcopy(annspec=annspec)
        doccopy.to_offset_type(&#34;j&#34;)
        json = doccopy.save_mem(fmt=&#34;json&#34;, **kwargs)
        htmlloc = os.path.join(
            os.path.dirname(__file__), &#34;_htmlviewer&#34;, HTML_TEMPLATE_FILE_NAME
        )
        if not os.path.exists(htmlloc):
            raise Exception(
                &#34;Could not find HTML template, {} does not exist&#34;.format(htmlloc)
            )
        with open(htmlloc, &#34;rt&#34;, encoding=&#34;utf-8&#34;) as infp:
            html = infp.read()
        txtcolor = gatenlpconfig.doc_html_repr_txtcolor
        if preselect is not None:
            # create a list of set/type lists and a set of set of setSEPtype for parms
            presel_set = set()
            presel_list = []
            for el in preselect:
                if isinstance(el, str):
                    for anntype in doccopy.annset(el).type_names:
                        settype = el + SEP + anntype
                        if settype not in presel_set:
                            presel_set.add(settype)
                            presel_list.append([el, anntype])
                elif isinstance(el, (list, tuple)) and len(el) &gt; 1:
                    setname = el[0]
                    anntypes = el[1]
                    if isinstance(anntypes, str):
                        anntypes = [anntypes]
                    for anntype in anntypes:
                        settype = setname + SEP + anntype
                        if settype not in presel_set:
                            presel_set.add(settype)
                            presel_list.append([setname, anntype])
            parms[&#34;presel_set&#34;] = list(presel_set)
            parms[&#34;presel_list&#34;] = presel_list
        if notebook:
            str_start = &#34;&lt;!--STARTDIV--&gt;&#34;
            str_end = &#34;&lt;!--ENDDIV--&gt;&#34;
            idx1 = html.find(str_start) + len(str_start)
            idx2 = html.find(str_end)
            if htmlid:
                rndpref = str(htmlid)
            else:
                rndpref = &#34;&#34;.join(choice(ascii_uppercase) for _i in range(10))
            html = html[idx1:idx2]
            html = f&#34;&#34;&#34;&lt;div&gt;&lt;style&gt;#{rndpref}-wrapper {{ color: {txtcolor} !important; }}&lt;/style&gt;
&lt;div id=&#34;{rndpref}-wrapper&#34;&gt;
{html}
&lt;/div&gt;&lt;/div&gt;&#34;&#34;&#34;
            # replace the prefix with a random one
            html = html.replace(&#34;GATENLPID&#34;, rndpref)
        if palette is not None:
            parms[&#34;palette&#34;] = palette
        if cols4types:
            newdict = {}
            for k, v in cols4types.items():
                if not isinstance(k, tuple) or not len(k) == 2 or not isinstance(v, str):
                    raise Exception(&#34;cols4types: must be a dictionary mapping (setname,typename) to color string&#34;)
                newdict[k[0]+SEP+k[1]] = v
            parms[&#34;cols4types&#34;] = newdict
        else:
            parms[&#34;cols4types&#34;] = {}
        if offline:
            # global html_ann_viewer_serializer_js_loaded
            # if not html_ann_viewer_serializer_js_loaded:
            if add_js:
                jsloc = os.path.join(
                    os.path.dirname(__file__), &#34;_htmlviewer&#34;, JS_GATENLP_FILE_NAME
                )
                if not os.path.exists(jsloc):
                    raise Exception(
                        &#34;Could not find JavsScript file, {} does not exist&#34;.format(
                            jsloc
                        )
                    )
                with open(jsloc, &#34;rt&#34;, encoding=&#34;utf-8&#34;) as infp:
                    js = infp.read()
                    js = &#34;&#34;&#34;&lt;script type=&#34;text/javascript&#34;&gt;&#34;&#34;&#34; + js + &#34;&lt;/script&gt;&#34;
                # html_ann_viewer_serializer_js_loaded = True
            else:
                js = &#34;&#34;
        else:
            js = JS_JQUERY + JS_GATENLP
        if stretch_height:
            if row1_style is None:
                row1_style = gatenlpconfig.doc_html_repr_row1style_stretch
            if row2_style is None:
                row2_style = gatenlpconfig.doc_html_repr_row2style_stretch
        else:
            if row1_style is None:
                row1_style = gatenlpconfig.doc_html_repr_row1style_nostretch
            if row2_style is None:
                row2_style = gatenlpconfig.doc_html_repr_row2style_nostretch
        html = html.replace(&#34;$$JAVASCRIPT$$&#34;, js, 1).replace(&#34;$$JSONDATA$$&#34;, json, 1)
        html = html.replace(&#34;$$JSONPARMS$$&#34;, jsonlib.dumps(parms), 1)
        html = html.replace(&#34;$$ROW1STYLE$$&#34;, row1_style, 1).replace(
            &#34;$$ROW2STYLE$$&#34;, row2_style, 1
        )
        if doc_style is None:
            doc_style = gatenlpconfig.doc_html_repr_doc_style
        if doc_style is None:
            doc_style = &#34;&#34;
        html = html.replace(&#34;$$TEXTSTYLE$$&#34;, doc_style, 1)
        if to_mem:
            return html
        else:
            with open(to_ext, &#34;wt&#34;, encoding=&#34;utf-8&#34;) as outfp:
                outfp.write(html)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="gatenlp.serialization.default_htmlannviewer.init_javscript"><code class="name flex">
<span>def <span class="ident">init_javscript</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Initialize the notebook/html javascript.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init_javscript():
    &#34;&#34;&#34;
    Initialize the notebook/html javascript.
    &#34;&#34;&#34;
    from IPython.display import display_html   # pylint: disable=C0415

    display_html(HtmlAnnViewerSerializer.javascript(), raw=True)</code></pre>
</details>
</dd>
<dt id="gatenlp.serialization.default_htmlannviewer.show_colab"><code class="name flex">
<span>def <span class="ident">show_colab</span></span>(<span>doc, htmlid=None, display=False, annspec=None, preselect=None, palette=None, cols4types=None, doc_style=None, row1_style=None, row2_style=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Show htmldocumentviewe in a colab notebook.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_colab(
        doc,
        htmlid=None,
        display=False,
        annspec=None,
        preselect=None,
        palette=None,
        cols4types=None,
        doc_style=None,
        row1_style=None,
        row2_style=None
):
    &#34;&#34;&#34;
    Show htmldocumentviewe in a colab notebook.
    &#34;&#34;&#34;
    from IPython.display import display_html, Javascript   # pylint: disable=C0415
    from IPython.display import display as i_display   # pylint: disable=C0415
    i_display(Javascript(url=JS_JQUERY_URL))
    i_display(Javascript(url=JS_GATENLP_URL))
    html = doc.save_mem(
        fmt=&#34;html-ann-viewer&#34;,
        notebook=True,
        add_js=False,
        offline=True,
        htmlid=htmlid,
        annspec=annspec,
        preselect=preselect,
        palette=palette,
        cols4types=cols4types,
        stretch_height=False,
        doc_style=doc_style,
        row1_style=row1_style,
        row2_style=row2_style,
    )
    if display:
        display_html(html, raw=True)
        return None
    else:
        return html</code></pre>
</details>
</dd>
<dt id="gatenlp.serialization.default_htmlannviewer.show_notebook"><code class="name flex">
<span>def <span class="ident">show_notebook</span></span>(<span>doc, htmlid=None, display=False, annspec=None, preselect=None, palette=None, cols4types=None, doc_style=None, row1_style=None, row2_style=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Show htmldocumentviewer in a jupyter notebook.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_notebook(
        doc,
        htmlid=None,
        display=False,
        annspec=None,
        preselect=None,
        palette=None,
        cols4types=None,
        doc_style=None,
        row1_style=None,
        row2_style=None
):
    &#34;&#34;&#34;
    Show htmldocumentviewer in a jupyter notebook.
    &#34;&#34;&#34;
    if not gatenlpconfig.notebook_js_initialized:
        init_javscript()
        gatenlpconfig.notebook_js_initialized = True
    html = doc.save_mem(
        fmt=&#34;html-ann-viewer&#34;,
        notebook=True,
        add_js=False,
        offline=True,
        htmlid=htmlid,
        annspec=annspec,
        preselect=preselect,
        palette=palette,
        cols4types=cols4types,
        stretch_height=False,
        doc_style=doc_style,
        row1_style=row1_style,
        row2_style=row2_style,
    )
    if display:
        from IPython.display import display_html  # pylint: disable=C0415
        display_html(html, raw=True)
        return None
    else:
        return html</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="gatenlp.serialization.default_htmlannviewer.HtmlAnnViewerSerializer"><code class="flex name class">
<span>class <span class="ident">HtmlAnnViewerSerializer</span></span>
</code></dt>
<dd>
<div class="desc"><p>Serialization class for generating HTML/Javascript to view a document in an HTML page or in a Jupyter or
Colab notebook.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class HtmlAnnViewerSerializer:
    &#34;&#34;&#34;
    Serialization class for generating HTML/Javascript to view a document in an HTML page or in a Jupyter or
    Colab notebook.
    &#34;&#34;&#34;

    @staticmethod
    def javascript():
        &#34;&#34;&#34;
        Return the Javascript needed for the HTML Annotation viewer.

        Returns: Javascript string.

        &#34;&#34;&#34;
        jsloc = os.path.join(
            os.path.dirname(__file__), &#34;_htmlviewer&#34;, JS_GATENLP_FILE_NAME
        )
        if not os.path.exists(jsloc):
            raise Exception(
                &#34;Could not find JavsScript file, {} does not exist&#34;.format(jsloc)
            )
        with open(jsloc, &#34;rt&#34;, encoding=&#34;utf-8&#34;) as infp:
            js = infp.read()
            js = &#34;&#34;&#34;&lt;script type=&#34;text/javascript&#34;&gt;&#34;&#34;&#34; + js + &#34;&lt;/script&gt;&#34;
        return js

    @staticmethod
    def save(
            _clazz,
            inst,
            to_ext=None,
            to_mem=None,
            notebook=False,
            offline=False,
            add_js=True,
            htmlid=None,
            stretch_height=False,
            annspec=None,
            preselect=None,
            palette=None,
            cols4types=None,
            doc_style=None,
            row1_style=None,
            row2_style=None,
            **kwargs,
    ):
        &#34;&#34;&#34;Convert a document to HTML for visualizing it.

        Args:
            _clazz: the class of the object to save
            inst: the instance/object to save
            to_ext:  the destination where to save to unless to_mem is given
            to_mem: if true, ignores to_ext and returns the representation
            notebook: if True only create a div which can be injected into a notebook or other HTML, otherwise
                generate a full HTML document
            offline: if true, include all the Javascript needed in the generated HTML , otherwise load library
                from the internet.
            add_js: if true (default), add the necessary Javascript either directly or by loading a library from
                the internet. If false, assume that the Javascript is already there (only makes sense with
                notebook=True).
            htmlid: the id to use for HTML ids so it is possible to have several independent viewers in the
                same HTML page and to style the output from a separate notebook cell
            stretch_height: if False, rows 1 and 2 of the viewer will not have the height set, but only
                min and max height (default min is 10em for row1 and 7em for row2, max is the double of those).
                If True, no max haight is set and instead the height is set to a percentage (default is
                67vh for row 1 and 30vh for row 2). The values used can be changed via gateconfig or the
                complete style for the rows can be set directly via row1_style and row2_style.
            annspec: if None, include all annotation sets and types, otherwise this should be a list of either
                set names, or tuples, where the first entry is a set name and the second entry is either a type
                name or list of type names to include.
            preselect: if not None, the set and type names to pre-select (show). This should have the same format
                as the annspec parameter.
            palette: if not None a list of colour codes (strings) usable in Javascript which will be used instead
                of the default palette.
            cols4types: if not None a dictionary mapping tuples (setname, typename) to a color. For the given
                setname and typename combinations, the colours from the palette (default or specified) will be
                overrriden.
            doc_style: if not None, any additional styling for the document text box, if None, use whatever
                is defined as gatenlpconfig.doc_html_repr_doc_style or do not use.
            row1_style: the style to use for the first row of the document viewer which shows the document text and
                annotation set and type panes. The default is gatenlpconfig.doc_html_repr_row1style_nostretch or
                gatenlpconfig.doc_html_repr_row1style_nostretch depending on the stretch_height parameter.
            row2_style: the style to use for the second row of the document viewer which shows the document or
                annotation features. The default is gatenlpconfig.doc_html_repr_row2style_nostretch or
                gatenlpconfig.doc_html_repr_row2style_nostretch depending on the stretch_height parameter.
            kwargs: swallow any other kwargs.

        Returns: if to_mem is True, returns the representation, otherwise None.

        &#34;&#34;&#34;
        if not isinstance(inst, Document):
            raise Exception(&#34;Not a document!&#34;)
        parms = dict(presel_set=[], presel_list=[])
        doccopy = inst.deepcopy(annspec=annspec)
        doccopy.to_offset_type(&#34;j&#34;)
        json = doccopy.save_mem(fmt=&#34;json&#34;, **kwargs)
        htmlloc = os.path.join(
            os.path.dirname(__file__), &#34;_htmlviewer&#34;, HTML_TEMPLATE_FILE_NAME
        )
        if not os.path.exists(htmlloc):
            raise Exception(
                &#34;Could not find HTML template, {} does not exist&#34;.format(htmlloc)
            )
        with open(htmlloc, &#34;rt&#34;, encoding=&#34;utf-8&#34;) as infp:
            html = infp.read()
        txtcolor = gatenlpconfig.doc_html_repr_txtcolor
        if preselect is not None:
            # create a list of set/type lists and a set of set of setSEPtype for parms
            presel_set = set()
            presel_list = []
            for el in preselect:
                if isinstance(el, str):
                    for anntype in doccopy.annset(el).type_names:
                        settype = el + SEP + anntype
                        if settype not in presel_set:
                            presel_set.add(settype)
                            presel_list.append([el, anntype])
                elif isinstance(el, (list, tuple)) and len(el) &gt; 1:
                    setname = el[0]
                    anntypes = el[1]
                    if isinstance(anntypes, str):
                        anntypes = [anntypes]
                    for anntype in anntypes:
                        settype = setname + SEP + anntype
                        if settype not in presel_set:
                            presel_set.add(settype)
                            presel_list.append([setname, anntype])
            parms[&#34;presel_set&#34;] = list(presel_set)
            parms[&#34;presel_list&#34;] = presel_list
        if notebook:
            str_start = &#34;&lt;!--STARTDIV--&gt;&#34;
            str_end = &#34;&lt;!--ENDDIV--&gt;&#34;
            idx1 = html.find(str_start) + len(str_start)
            idx2 = html.find(str_end)
            if htmlid:
                rndpref = str(htmlid)
            else:
                rndpref = &#34;&#34;.join(choice(ascii_uppercase) for _i in range(10))
            html = html[idx1:idx2]
            html = f&#34;&#34;&#34;&lt;div&gt;&lt;style&gt;#{rndpref}-wrapper {{ color: {txtcolor} !important; }}&lt;/style&gt;
&lt;div id=&#34;{rndpref}-wrapper&#34;&gt;
{html}
&lt;/div&gt;&lt;/div&gt;&#34;&#34;&#34;
            # replace the prefix with a random one
            html = html.replace(&#34;GATENLPID&#34;, rndpref)
        if palette is not None:
            parms[&#34;palette&#34;] = palette
        if cols4types:
            newdict = {}
            for k, v in cols4types.items():
                if not isinstance(k, tuple) or not len(k) == 2 or not isinstance(v, str):
                    raise Exception(&#34;cols4types: must be a dictionary mapping (setname,typename) to color string&#34;)
                newdict[k[0]+SEP+k[1]] = v
            parms[&#34;cols4types&#34;] = newdict
        else:
            parms[&#34;cols4types&#34;] = {}
        if offline:
            # global html_ann_viewer_serializer_js_loaded
            # if not html_ann_viewer_serializer_js_loaded:
            if add_js:
                jsloc = os.path.join(
                    os.path.dirname(__file__), &#34;_htmlviewer&#34;, JS_GATENLP_FILE_NAME
                )
                if not os.path.exists(jsloc):
                    raise Exception(
                        &#34;Could not find JavsScript file, {} does not exist&#34;.format(
                            jsloc
                        )
                    )
                with open(jsloc, &#34;rt&#34;, encoding=&#34;utf-8&#34;) as infp:
                    js = infp.read()
                    js = &#34;&#34;&#34;&lt;script type=&#34;text/javascript&#34;&gt;&#34;&#34;&#34; + js + &#34;&lt;/script&gt;&#34;
                # html_ann_viewer_serializer_js_loaded = True
            else:
                js = &#34;&#34;
        else:
            js = JS_JQUERY + JS_GATENLP
        if stretch_height:
            if row1_style is None:
                row1_style = gatenlpconfig.doc_html_repr_row1style_stretch
            if row2_style is None:
                row2_style = gatenlpconfig.doc_html_repr_row2style_stretch
        else:
            if row1_style is None:
                row1_style = gatenlpconfig.doc_html_repr_row1style_nostretch
            if row2_style is None:
                row2_style = gatenlpconfig.doc_html_repr_row2style_nostretch
        html = html.replace(&#34;$$JAVASCRIPT$$&#34;, js, 1).replace(&#34;$$JSONDATA$$&#34;, json, 1)
        html = html.replace(&#34;$$JSONPARMS$$&#34;, jsonlib.dumps(parms), 1)
        html = html.replace(&#34;$$ROW1STYLE$$&#34;, row1_style, 1).replace(
            &#34;$$ROW2STYLE$$&#34;, row2_style, 1
        )
        if doc_style is None:
            doc_style = gatenlpconfig.doc_html_repr_doc_style
        if doc_style is None:
            doc_style = &#34;&#34;
        html = html.replace(&#34;$$TEXTSTYLE$$&#34;, doc_style, 1)
        if to_mem:
            return html
        else:
            with open(to_ext, &#34;wt&#34;, encoding=&#34;utf-8&#34;) as outfp:
                outfp.write(html)</code></pre>
</details>
<h3>Static methods</h3>
<dl>
<dt id="gatenlp.serialization.default_htmlannviewer.HtmlAnnViewerSerializer.javascript"><code class="name flex">
<span>def <span class="ident">javascript</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Return the Javascript needed for the HTML Annotation viewer.</p>
<p>Returns: Javascript string.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@staticmethod
def javascript():
    &#34;&#34;&#34;
    Return the Javascript needed for the HTML Annotation viewer.

    Returns: Javascript string.

    &#34;&#34;&#34;
    jsloc = os.path.join(
        os.path.dirname(__file__), &#34;_htmlviewer&#34;, JS_GATENLP_FILE_NAME
    )
    if not os.path.exists(jsloc):
        raise Exception(
            &#34;Could not find JavsScript file, {} does not exist&#34;.format(jsloc)
        )
    with open(jsloc, &#34;rt&#34;, encoding=&#34;utf-8&#34;) as infp:
        js = infp.read()
        js = &#34;&#34;&#34;&lt;script type=&#34;text/javascript&#34;&gt;&#34;&#34;&#34; + js + &#34;&lt;/script&gt;&#34;
    return js</code></pre>
</details>
</dd>
<dt id="gatenlp.serialization.default_htmlannviewer.HtmlAnnViewerSerializer.save"><code class="name flex">
<span>def <span class="ident">save</span></span>(<span>_clazz, inst, to_ext=None, to_mem=None, notebook=False, offline=False, add_js=True, htmlid=None, stretch_height=False, annspec=None, preselect=None, palette=None, cols4types=None, doc_style=None, row1_style=None, row2_style=None, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Convert a document to HTML for visualizing it.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>_clazz</code></strong></dt>
<dd>the class of the object to save</dd>
<dt><strong><code>inst</code></strong></dt>
<dd>the instance/object to save</dd>
<dt><strong><code>to_ext</code></strong></dt>
<dd>the destination where to save to unless to_mem is given</dd>
<dt><strong><code>to_mem</code></strong></dt>
<dd>if true, ignores to_ext and returns the representation</dd>
<dt><strong><code>notebook</code></strong></dt>
<dd>if True only create a div which can be injected into a notebook or other HTML, otherwise
generate a full HTML document</dd>
<dt><strong><code>offline</code></strong></dt>
<dd>if true, include all the Javascript needed in the generated HTML , otherwise load library
from the internet.</dd>
<dt><strong><code>add_js</code></strong></dt>
<dd>if true (default), add the necessary Javascript either directly or by loading a library from
the internet. If false, assume that the Javascript is already there (only makes sense with
notebook=True).</dd>
<dt><strong><code>htmlid</code></strong></dt>
<dd>the id to use for HTML ids so it is possible to have several independent viewers in the
same HTML page and to style the output from a separate notebook cell</dd>
<dt><strong><code>stretch_height</code></strong></dt>
<dd>if False, rows 1 and 2 of the viewer will not have the height set, but only
min and max height (default min is 10em for row1 and 7em for row2, max is the double of those).
If True, no max haight is set and instead the height is set to a percentage (default is
67vh for row 1 and 30vh for row 2). The values used can be changed via gateconfig or the
complete style for the rows can be set directly via row1_style and row2_style.</dd>
<dt><strong><code>annspec</code></strong></dt>
<dd>if None, include all annotation sets and types, otherwise this should be a list of either
set names, or tuples, where the first entry is a set name and the second entry is either a type
name or list of type names to include.</dd>
<dt><strong><code>preselect</code></strong></dt>
<dd>if not None, the set and type names to pre-select (show). This should have the same format
as the annspec parameter.</dd>
<dt><strong><code>palette</code></strong></dt>
<dd>if not None a list of colour codes (strings) usable in Javascript which will be used instead
of the default palette.</dd>
<dt><strong><code>cols4types</code></strong></dt>
<dd>if not None a dictionary mapping tuples (setname, typename) to a color. For the given
setname and typename combinations, the colours from the palette (default or specified) will be
overrriden.</dd>
<dt><strong><code>doc_style</code></strong></dt>
<dd>if not None, any additional styling for the document text box, if None, use whatever
is defined as gatenlpconfig.doc_html_repr_doc_style or do not use.</dd>
<dt><strong><code>row1_style</code></strong></dt>
<dd>the style to use for the first row of the document viewer which shows the document text and
annotation set and type panes. The default is gatenlpconfig.doc_html_repr_row1style_nostretch or
gatenlpconfig.doc_html_repr_row1style_nostretch depending on the stretch_height parameter.</dd>
<dt><strong><code>row2_style</code></strong></dt>
<dd>the style to use for the second row of the document viewer which shows the document or
annotation features. The default is gatenlpconfig.doc_html_repr_row2style_nostretch or
gatenlpconfig.doc_html_repr_row2style_nostretch depending on the stretch_height parameter.</dd>
<dt><strong><code>kwargs</code></strong></dt>
<dd>swallow any other kwargs.</dd>
</dl>
<p>Returns: if to_mem is True, returns the representation, otherwise None.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">    @staticmethod
    def save(
            _clazz,
            inst,
            to_ext=None,
            to_mem=None,
            notebook=False,
            offline=False,
            add_js=True,
            htmlid=None,
            stretch_height=False,
            annspec=None,
            preselect=None,
            palette=None,
            cols4types=None,
            doc_style=None,
            row1_style=None,
            row2_style=None,
            **kwargs,
    ):
        &#34;&#34;&#34;Convert a document to HTML for visualizing it.

        Args:
            _clazz: the class of the object to save
            inst: the instance/object to save
            to_ext:  the destination where to save to unless to_mem is given
            to_mem: if true, ignores to_ext and returns the representation
            notebook: if True only create a div which can be injected into a notebook or other HTML, otherwise
                generate a full HTML document
            offline: if true, include all the Javascript needed in the generated HTML , otherwise load library
                from the internet.
            add_js: if true (default), add the necessary Javascript either directly or by loading a library from
                the internet. If false, assume that the Javascript is already there (only makes sense with
                notebook=True).
            htmlid: the id to use for HTML ids so it is possible to have several independent viewers in the
                same HTML page and to style the output from a separate notebook cell
            stretch_height: if False, rows 1 and 2 of the viewer will not have the height set, but only
                min and max height (default min is 10em for row1 and 7em for row2, max is the double of those).
                If True, no max haight is set and instead the height is set to a percentage (default is
                67vh for row 1 and 30vh for row 2). The values used can be changed via gateconfig or the
                complete style for the rows can be set directly via row1_style and row2_style.
            annspec: if None, include all annotation sets and types, otherwise this should be a list of either
                set names, or tuples, where the first entry is a set name and the second entry is either a type
                name or list of type names to include.
            preselect: if not None, the set and type names to pre-select (show). This should have the same format
                as the annspec parameter.
            palette: if not None a list of colour codes (strings) usable in Javascript which will be used instead
                of the default palette.
            cols4types: if not None a dictionary mapping tuples (setname, typename) to a color. For the given
                setname and typename combinations, the colours from the palette (default or specified) will be
                overrriden.
            doc_style: if not None, any additional styling for the document text box, if None, use whatever
                is defined as gatenlpconfig.doc_html_repr_doc_style or do not use.
            row1_style: the style to use for the first row of the document viewer which shows the document text and
                annotation set and type panes. The default is gatenlpconfig.doc_html_repr_row1style_nostretch or
                gatenlpconfig.doc_html_repr_row1style_nostretch depending on the stretch_height parameter.
            row2_style: the style to use for the second row of the document viewer which shows the document or
                annotation features. The default is gatenlpconfig.doc_html_repr_row2style_nostretch or
                gatenlpconfig.doc_html_repr_row2style_nostretch depending on the stretch_height parameter.
            kwargs: swallow any other kwargs.

        Returns: if to_mem is True, returns the representation, otherwise None.

        &#34;&#34;&#34;
        if not isinstance(inst, Document):
            raise Exception(&#34;Not a document!&#34;)
        parms = dict(presel_set=[], presel_list=[])
        doccopy = inst.deepcopy(annspec=annspec)
        doccopy.to_offset_type(&#34;j&#34;)
        json = doccopy.save_mem(fmt=&#34;json&#34;, **kwargs)
        htmlloc = os.path.join(
            os.path.dirname(__file__), &#34;_htmlviewer&#34;, HTML_TEMPLATE_FILE_NAME
        )
        if not os.path.exists(htmlloc):
            raise Exception(
                &#34;Could not find HTML template, {} does not exist&#34;.format(htmlloc)
            )
        with open(htmlloc, &#34;rt&#34;, encoding=&#34;utf-8&#34;) as infp:
            html = infp.read()
        txtcolor = gatenlpconfig.doc_html_repr_txtcolor
        if preselect is not None:
            # create a list of set/type lists and a set of set of setSEPtype for parms
            presel_set = set()
            presel_list = []
            for el in preselect:
                if isinstance(el, str):
                    for anntype in doccopy.annset(el).type_names:
                        settype = el + SEP + anntype
                        if settype not in presel_set:
                            presel_set.add(settype)
                            presel_list.append([el, anntype])
                elif isinstance(el, (list, tuple)) and len(el) &gt; 1:
                    setname = el[0]
                    anntypes = el[1]
                    if isinstance(anntypes, str):
                        anntypes = [anntypes]
                    for anntype in anntypes:
                        settype = setname + SEP + anntype
                        if settype not in presel_set:
                            presel_set.add(settype)
                            presel_list.append([setname, anntype])
            parms[&#34;presel_set&#34;] = list(presel_set)
            parms[&#34;presel_list&#34;] = presel_list
        if notebook:
            str_start = &#34;&lt;!--STARTDIV--&gt;&#34;
            str_end = &#34;&lt;!--ENDDIV--&gt;&#34;
            idx1 = html.find(str_start) + len(str_start)
            idx2 = html.find(str_end)
            if htmlid:
                rndpref = str(htmlid)
            else:
                rndpref = &#34;&#34;.join(choice(ascii_uppercase) for _i in range(10))
            html = html[idx1:idx2]
            html = f&#34;&#34;&#34;&lt;div&gt;&lt;style&gt;#{rndpref}-wrapper {{ color: {txtcolor} !important; }}&lt;/style&gt;
&lt;div id=&#34;{rndpref}-wrapper&#34;&gt;
{html}
&lt;/div&gt;&lt;/div&gt;&#34;&#34;&#34;
            # replace the prefix with a random one
            html = html.replace(&#34;GATENLPID&#34;, rndpref)
        if palette is not None:
            parms[&#34;palette&#34;] = palette
        if cols4types:
            newdict = {}
            for k, v in cols4types.items():
                if not isinstance(k, tuple) or not len(k) == 2 or not isinstance(v, str):
                    raise Exception(&#34;cols4types: must be a dictionary mapping (setname,typename) to color string&#34;)
                newdict[k[0]+SEP+k[1]] = v
            parms[&#34;cols4types&#34;] = newdict
        else:
            parms[&#34;cols4types&#34;] = {}
        if offline:
            # global html_ann_viewer_serializer_js_loaded
            # if not html_ann_viewer_serializer_js_loaded:
            if add_js:
                jsloc = os.path.join(
                    os.path.dirname(__file__), &#34;_htmlviewer&#34;, JS_GATENLP_FILE_NAME
                )
                if not os.path.exists(jsloc):
                    raise Exception(
                        &#34;Could not find JavsScript file, {} does not exist&#34;.format(
                            jsloc
                        )
                    )
                with open(jsloc, &#34;rt&#34;, encoding=&#34;utf-8&#34;) as infp:
                    js = infp.read()
                    js = &#34;&#34;&#34;&lt;script type=&#34;text/javascript&#34;&gt;&#34;&#34;&#34; + js + &#34;&lt;/script&gt;&#34;
                # html_ann_viewer_serializer_js_loaded = True
            else:
                js = &#34;&#34;
        else:
            js = JS_JQUERY + JS_GATENLP
        if stretch_height:
            if row1_style is None:
                row1_style = gatenlpconfig.doc_html_repr_row1style_stretch
            if row2_style is None:
                row2_style = gatenlpconfig.doc_html_repr_row2style_stretch
        else:
            if row1_style is None:
                row1_style = gatenlpconfig.doc_html_repr_row1style_nostretch
            if row2_style is None:
                row2_style = gatenlpconfig.doc_html_repr_row2style_nostretch
        html = html.replace(&#34;$$JAVASCRIPT$$&#34;, js, 1).replace(&#34;$$JSONDATA$$&#34;, json, 1)
        html = html.replace(&#34;$$JSONPARMS$$&#34;, jsonlib.dumps(parms), 1)
        html = html.replace(&#34;$$ROW1STYLE$$&#34;, row1_style, 1).replace(
            &#34;$$ROW2STYLE$$&#34;, row2_style, 1
        )
        if doc_style is None:
            doc_style = gatenlpconfig.doc_html_repr_doc_style
        if doc_style is None:
            doc_style = &#34;&#34;
        html = html.replace(&#34;$$TEXTSTYLE$$&#34;, doc_style, 1)
        if to_mem:
            return html
        else:
            with open(to_ext, &#34;wt&#34;, encoding=&#34;utf-8&#34;) as outfp:
                outfp.write(html)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="gatenlp.serialization" href="index.html">gatenlp.serialization</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="gatenlp.serialization.default_htmlannviewer.init_javscript" href="#gatenlp.serialization.default_htmlannviewer.init_javscript">init_javscript</a></code></li>
<li><code><a title="gatenlp.serialization.default_htmlannviewer.show_colab" href="#gatenlp.serialization.default_htmlannviewer.show_colab">show_colab</a></code></li>
<li><code><a title="gatenlp.serialization.default_htmlannviewer.show_notebook" href="#gatenlp.serialization.default_htmlannviewer.show_notebook">show_notebook</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="gatenlp.serialization.default_htmlannviewer.HtmlAnnViewerSerializer" href="#gatenlp.serialization.default_htmlannviewer.HtmlAnnViewerSerializer">HtmlAnnViewerSerializer</a></code></h4>
<ul class="">
<li><code><a title="gatenlp.serialization.default_htmlannviewer.HtmlAnnViewerSerializer.javascript" href="#gatenlp.serialization.default_htmlannviewer.HtmlAnnViewerSerializer.javascript">javascript</a></code></li>
<li><code><a title="gatenlp.serialization.default_htmlannviewer.HtmlAnnViewerSerializer.save" href="#gatenlp.serialization.default_htmlannviewer.HtmlAnnViewerSerializer.save">save</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>